<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Suburb Insight Report – Fernbrook, NSW</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Lato:wght@400;700;900&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css">
    <script src="https://cdn.jsdelivr.net/npm/xlsx@0.18.5/dist/xlsx.full.min.js"></script>
    

    <style>
        :root {
            --font-family: 'Lato', 'Segoe UI', Roboto, sans-serif;
            --primary-color: #0D2A4C;
            --secondary-color: #3A7CA5;
            --background-color: #F7F9FA;
            --card-background: #FFFFFF;
            --text-color: #333333;
            --border-color: #EAEFF4;
            --shadow-color: rgba(13, 42, 76, 0.1);
        }

        body {
            font-family: var(--font-family);
            background: var(--background-color);
            color: var(--text-color);
            margin: 0;
            padding: 0;
            display: flex;
            justify-content: center;
            font-size: 15px;
            -webkit-font-smoothing: antialiased;
        }

        .page {
            background: var(--card-background);
            width: 210mm;
            min-height: 297mm;
            margin: 20px;
            padding: 12mm;
            box-sizing: border-box;
            box-shadow: 0 5px 25px rgba(0, 0, 0, 0.1);
        }

        .report-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            border-bottom: 2px solid var(--primary-color);
            padding-bottom: 20px;
            margin-bottom: 30px;
        }

        .report-header .logo {
            font-weight: 900;
            font-size: 24px;
            color: var(--primary-color);
        }

        .report-header .title-block h1 {
            font-size: 36px;
            font-weight: 900;
            color: var(--primary-color);
            margin: 0 0 5px 0;
            text-align: right;
        }

        .report-header .title-block p {
            font-size: 16px;
            color: var(--secondary-color);
            margin: 0;
            text-align: right;
        }

        footer {
            text-align: center;
            margin-top: 40px;
            padding-top: 20px;
            border-top: 1px solid var(--border-color);
            font-size: 12px;
            color: #999;
        }

        .section {
            background: var(--card-background);
            border: 1px solid var(--border-color);
            border-radius: 8px;
            padding: 15px;
            box-shadow: 0 4px 15px var(--shadow-color);
            margin-bottom: 25px;
        }

        .section-header {
            display: flex;
            align-items: center;
            margin-bottom: 15px;
            border-bottom: 1px solid var(--border-color);
            padding-bottom: 12px;
        }

        .section-header i {
            font-size: 20px;
            color: var(--secondary-color);
            margin-right: 15px;
            width: 25px;
        }

        .section-header h2 {
            font-size: 18px;
            font-weight: 700;
            color: var(--primary-color);
            margin: 0;
        }

        table {
            width: 100%;
            border-collapse: collapse;
        }

        td {
            padding: 8px 5px;
            vertical-align: top;
            font-size: 14px;
            border-bottom: 1px solid var(--border-color);
        }

        tr:last-child td {
            border-bottom: none;
        }

        td:nth-child(1) {
            font-weight: 700;
            color: #555;
            width: 50%;
        }

        td:nth-child(2) {
            width: 20%;
        }

        td:nth-child(3) {
            width: 20%;
            text-align: right;
            font-size: 0.95em;
        }

        .rating {
            font-size: 20px;
            letter-spacing: 2px;
        }

        .rating .filled {
            color: #FFC107;
        }

        .rating .empty {
            color: #DDE4E9;
        }

        #housing-type-mix, #dwelling-ownership, #top-occupations, #languages-spoken, #median-age, #median-income {
            font-weight: normal;
            display: inline-block;
            margin-top: 4px; /* or 6px for more space */
        }

        .age-diff {
            font-weight: 500;
            font-size: 0.95em;
            padding-left: 6px;
            white-space: nowrap;
        }

        .age-diff.up {
            color: #c62828;
        }

        .age-diff.down {
            color: #2e7d32;
        }

        .age-diff.neutral {
            color: #1565c0;
        }


        #secondary-line {
        font-weight: normal !important;
        color: #666;
        display: block;
        }

        .four-column-table td,
.four-column-table th {
    padding: 8px 5px;
    vertical-align: top;
    font-size: 14px;
    border-bottom: 1px solid var(--border-color);
    word-wrap: break-word;
    overflow-wrap: break-word;
}

.four-column-table {
    width: 100%;
    table-layout: fixed;
}

.four-column-table tr:last-child td {
    border-bottom: none;
}

.four-column-table td:nth-child(1),
.four-column-table th:nth-child(1) {
    font-weight: 700;
    color: #555;
    text-align: left;
}

.four-column-table td:nth-child(n+2),
.four-column-table th:nth-child(n+2) {
    text-align: right;
    font-size: 0.95em;
}

.four-column-table td:nth-child(2),
.four-column-table td:nth-child(3),
.four-column-table th:nth-child(2),
.four-column-table th:nth-child(3) {
    text-align: center;
}




        @media print {
            body {
                background: #FFF;
            }
            .page {
                width: 100%;
                min-height: auto;
                margin: 0;
                padding: 15mm 20mm;
                box-shadow: none;
            }
            .section {
                box-shadow: none;
                border: 1px solid #ccc;
                min-height: auto;
            }
        }
    </style>
</head>
<body>
<div class="page">
    <header class="report-header">
        <input type="file" id="upload" accept=".xlsx, .xls" />
        <div class="logo">YourLogo</div>
        <div class="title-block">
            <h1>Suburb Insight Report</h1>
            <p id="suburb-name">Fernbrook, NSW 2147</p>
        </div>
    </header>

    <main>
        <!-- Suburb Snapshot -->
        <div class="section">
            <div class="section-header">
                <i class="fa-solid fa-chart-pie"></i>
                <h2>Suburb Snapshot</h2>
            </div>
            <table>
                <tr><td>Population</td><td id="population">4,250</td><td id="population-diff"></td></tr>
                <tr><td>Median age</td><td id="median-age">36</td><td id="median-age-diff">↑ 2.1 vs avg</td></tr>
                <tr><td>Families with children</td><td id="families-with-children">48%</td><td id="families-children-diff">↑ 6% vs avg</td></tr>
                <tr><td>Residents born overseas</td><td id="born-overseas">38%</td><td id="born-overseas-diff">↓ 4% vs avg</td></tr>
                <tr><td>Median weekly household income (2025 estimate)</td><td id="median-income-2025">$1,850/wk</td><td id="income-diff">Top 25%</td></tr>
                <tr><td colspan="3" style="font-weight: normal;">The median household income is greater than <span id="median-income">50%</span></td></tr>
            </table>
        </div>

        <!-- Housing & Rent -->
        <div class="section">
            <div class="section-header">
                <i class="fa-solid fa-house-chimney"></i>
                <h2>Housing & Rent</h2>
            </div>
            <table>
                <tr><td>Percentage of renters</td><td id="renters-percent">25%</td><td id="renter-comparison">Avg</td></tr>
                <tr><td>Median weekly rent</td><td id="median-rent">$550</td><td id="median-rent-comparison">Top 30%</td></tr>
                <tr><td>1-2 bedroom dwellings</td><td id="one-two-bed">29%</td><td id="one-two-bed-comparison"></td></tr>
                <tr><td>3+ bedroom dwellings</td><td id="three-bed-plus">71%</td><td id="three-bed-comparison"></td></tr>
                <tr><td colspan="2">Housing type mix: <span id="housing-type-mix">67% Houses, 15% Apartments</span></td></tr>
                <tr><td colspan="3">Dwelling ownership: <span id="dwelling-ownership">35% Owned, 40% Mortgaged</span></td></tr>
            </table>
        </div>

        <!-- Resident Profile -->
        <div class="section">
            <div class="section-header">
                <i class="fa-solid fa-users"></i>
                <h2>Resident Profile</h2>
            </div>
            <table>
                <tr><td>Work from home rate</td><td id="wfh-rate">22%</td><td id="wfh-comparison">↑ 8% vs avg</td></tr>
                <tr><td>University educated (Bachelor's degree minimum)</td><td id="uni-educated">58%</td><td id="uni-comparison">Top 15%</td></tr>
                <tr><td colspan="3">Top Occupations:<br><span id="top-occupations"></span></td></tr>
                <tr><td colspan="2">Languages spoken other than English: <span id="languages-spoken">English, Mandarin, Hindi</span></td></tr>
            </table>
        </div>

        <!-- Amenities & Services -->
        <div class="section amenities-section">
                <table class="four-column-table">
                <colgroup>
                    <col style="width: 45%;">
                    <col style="width: 15%;">
                    <col style="width: 15%;">
                    <col style="width: 25%;">
                </colgroup>
                <thead>
                    <tr>
                        <th style="padding-left: 0; padding-bottom: 12px;">
                            <i class="fa-solid fa-store" style="font-size: 20px; color: var(--secondary-color); margin-right: 15px;"></i>
                            <span style="font-size: 18px; font-weight: 700; color: var(--primary-color);">Amenities & Services</span>
                        </th>
                        <th>In Suburb</th>
                        <th>Within 2km</th>
                        <th>Local Average (+2km*)</th>
                    </tr>
                </thead>

                <tbody>
                    <tr><td>Cafés, restaurants, bars and bakeries</td><td id="cafes-restaurants">12</td><td id="cafes-2km">24</td><td id="cafes-comparison">Above avg</td></tr>
                    <tr><td>Supermarkets - small and large</td><td id="supermarkets">2</td><td id="supermarkets-2km">5</td><td id="supermarkets-comparison">Avg</td></tr>
                    <tr><td>Medical, including GP clinics and specialists</td><td id="gp-clinics">3</td><td id="gp-2km">6</td><td id="gp-comparison">Avg</td></tr>
                    <tr><td>Childcare, daycare, early learning centres</td><td id="childcare">2</td><td id="childcare-2km">4</td><td id="childcare-comparison">Avg</td></tr>
                    <tr><td>Schools nearby - primary and high school</td><td id="schools-nearby">2 Primary, 1 High School</td><td id="schools-2km">4 Primary, 3 High School</td><td id="schools-comparison"></td></tr>
                    <tr><td>Parks, playgrounds and green space</td><td id="parks-green-space">8 Public Parks</td><td id="parks-2km">14 Public Parks</td><td id="parks-comparison">High</td></tr>
                    <tr><td colspan="4" style="font-weight: normal; text-align: right;">* Amenities and services in suburbs within 2km of listed suburb</td></tr>
                </tbody>
            </table>
        </div>



        <!-- Transport & Access -->
        <div class="section">
            <div class="section-header">
                <i class="fa-solid fa-bus"></i>
                <h2>Transport & Access</h2>
            </div>
            <table>
                <tr><td>Commute to work in a a car</td><td id="car-dependency">88% drive to work</td><td id="car-comparison">↑ vs avg</td></tr>
                <tr><td>CBD commute by car - total time</td><td id="commute-car">28 mins</td><td id="commute-car-comparison"></td></tr>
                <tr><td>CBD commute by public transport - total time</td><td id="commute-pt">38 mins</td><td id="commute-pt-comparison"></td></tr>
            </table>
        </div>

        <!-- Lifestyle Fit -->
        <div class="section">
            <div class="section-header">
                <i class="fa-solid fa-star"></i>
                <h2>Lifestyle Fit</h2>
            </div>
            <table>
                <tr><td>WFH Suitability<div id="secondary-line">Work from home data, job type, dwelling suitability and commute difficulty</div></td><td style="text-align: center;"><div class="rating" id="rating-wfh"><span class="filled">★★★★</span><span class="empty">☆</span></div></td></tr>
                <tr><td>Family Friendliness<div id="secondary-line">Suburb mix of families, younger children and access to community services</div></td><td style="text-align: center;"><div class="rating" id="rating-family"><span class="filled">★★★★★</span></div></td></tr>
                <tr><td>Nightlife / Social<div id="secondary-line">Access to local restaurants, bars and cafes</div></td><td style="text-align: center;"><div class="rating" id="rating-nightlife"><span class="filled">★★</span><span class="empty">☆☆☆</span></div></td></tr>
                <tr><td>Public Transport<div id="secondary-line">Public transport popularity within suburb, ease of commute</div></td><td style="text-align: center;"><div class="rating" id="rating-transport"><span class="filled">★★★</span><span class="empty">☆☆</span></div></td></tr>
                <tr><td>Cultural Diversity<div id="secondary-line">Cultural diversity throughout the suburb</div></td><td style="text-align: center;"><div class="rating" id="rating-diversity"><span class="filled">★★★★</span><span class="empty">☆</span></div></td></tr>
            </table>
        </div>
    </main>

    <footer>
        Report generated on July 4, 2025. Data sourced from ABS, Domain.com.au, and local council records.<br />
        © 2025 Your Company Name. All Rights Reserved.
    </footer>
</div>
<script>
document.getElementById('upload').addEventListener('change', function(e) {
    const file = e.target.files[0];
    const reader = new FileReader();

    reader.onload = function(event) {
        const data = new Uint8Array(event.target.result);
        const workbook = XLSX.read(data, {type: 'array'});
        const sheet = workbook.Sheets[workbook.SheetNames[0]];

        const dataMap = {
            'population': sheet['B3']?.v || 'N/A',
            'population-diff': formatComparison(sheet['B52']?.v, '%', 0),
            'median-age': sheet['B4']?.v || 'N/A',
            'median-age-diff': (() => {
                const diff = Math.round(sheet['B51']?.v ?? 0);

                if (diff == null || isNaN(diff)) return '';

                const absDiff = Math.abs(diff);
                const direction = diff > 0 ? 'up' : 'down';
                const arrow = diff > 0 ? '▲' : '▼';
                const label = diff > 0 ? 'yrs above region avg' : 'yrs below region avg';

                return `<span class="age-diff ${direction}">${arrow} ${absDiff} ${label}</span>`;
            })(),
            'median-income': Math.round((sheet['B5']?.v ?? 0) ) + '% of suburbs in this region.',
            'median-income-2025': `$${Math.round(sheet['B71']?.v ?? 0).toLocaleString()}`,
            'income-diff': formatComparison(sheet['B53']?.v, '%', 0),
            'families-with-children': Math.round((sheet['B6']?.v ?? 0) * 100 ) + '%',
            'families-children-diff': formatComparison(sheet['B54']?.v, '%', 0),
            'born-overseas': Math.round((sheet['B7']?.v ?? 0) * 100 ) + '%',
            'born-overseas-diff': formatComparison(sheet['B55']?.v, '%', 0),
            'dwelling-ownership': `${Math.round((sheet['B10']?.v ?? 0) * 100)}% of homes are fully owned, ${Math.round((sheet['B11']?.v ?? 0) * 100)}% are owned with a mortgage`,
            'housing-type-mix': `${Math.floor((sheet['B8']?.v ?? 0) * 100)}% are houses, ${Math.floor((sheet['B9']?.v ?? 0) * 100)}% are apartments or townhouses`,
            'renters-percent': Math.round((sheet['B14']?.v ?? 0) * 100 ) + '%',
            'renter-comparison': formatComparison(sheet['B56']?.v, '%', 0),
            'median-rent': Math.round((sheet['B15']?.v ?? 0) ) + '%',
            'median-rent-comparison': formatComparison(sheet['B57']?.v, '%', 0),
            'one-two-bed': sheet['B16']?.v || 'N/A',
            'one-two-bed-comparison': formatComparison(sheet['B58']?.v, '%', 0),
            'three-bed-plus': sheet['B17']?.v || 'N/A',
            'three-bed-comparison': formatComparison(sheet['B59']?.v, '%', 0),

            'wfh-rate': Math.round((sheet['B21']?.v ?? 0) * 100 ) + '%',
            'wfh-comparison': formatComparison(sheet['B60']?.v, '%', 0),
            'top-occupations': `${sheet['B22']?.v || 'N/A'}, ${sheet['B23']?.v || 'N/A'}, ${sheet['B24']?.v || 'N/A'}`,
            'uni-educated': Math.round((sheet['B25']?.v ?? 0) * 100 ) + '%',
            'uni-comparison': formatComparison(sheet['B61']?.v, '%', 0),
            'languages-spoken': `${sheet['B26']?.v || 'N/A'}, ${sheet['B27']?.v || 'N/A'}, ${sheet['B28']?.v || 'N/A'}`,

            'cafes-restaurants': sheet['B31']?.v || 'N/A',
            'cafes-2km': sheet['B74']?.v || 'N/A',
            'cafes-comparison': formatComparison(sheet['B81']?.v, '', 0),
            'supermarkets': sheet['B32']?.v ?? 'N/A',
            'supermarkets-2km': sheet['B75']?.v ?? 'N/A',
            'supermarkets-comparison': formatComparison(sheet['B82']?.v, '', 0),
            'gp-clinics': sheet['B33']?.v || 'N/A',
            'gp-2km': sheet['B76']?.v || 'N/A',
            'gp-comparison': formatComparison(sheet['B83']?.v, '', 0),
            'childcare': sheet['B34']?.v || 'N/A',
            'childcare-2km': sheet['B77']?.v || 'N/A',
            'childcare-comparison': formatComparison(sheet['B84']?.v, '', 0),
            'schools-nearby': sheet['B35']?.v || 'N/A',
            'schools-2km': sheet['B78']?.v || 'N/A',
            'schools-comparison': formatComparison(sheet['B85']?.v, '', 0),
            'parks-green-space': sheet['B36']?.v || 'N/A',
            'parks-2km': sheet['B79']?.v || 'N/A',
            'parks-comparison': formatComparison(sheet['B86']?.v, '', 0),

            'car-dependency': Math.round((sheet['B40']?.v ?? 0) * 100 ) + '%',
            'car-comparison': formatComparison(sheet['B69']?.v, '%', 0),
            'commute-car': sheet['B41']?.v ? sheet['B41'].v + ' mins' : 'N/A',
            'commute-car-comparison': formatComparison(sheet['B70']?.v, 'mins', 0),
            'commute-pt': sheet['B39']?.v ? sheet['B39'].v + ' mins' : 'N/A',
            'commute-pt-comparison': formatComparison(sheet['B68']?.v, 'mins', 0),


            'suburb-name': sheet['B1']?.v || 'N/A',

            'rating-wfh': renderStars(Math.floor(sheet['B44']?.v ?? 0)),
            'rating-family': renderStars(Math.floor(sheet['B45']?.v ?? 0)),
            'rating-nightlife': renderStars(Math.floor(sheet['B46']?.v ?? 0)),
            'rating-transport': renderStars(Math.floor(sheet['B47']?.v ?? 0)),
            'rating-diversity': renderStars(Math.floor(sheet['B48']?.v ?? 0))
        };

        function renderStars(score) {
            const filled = '★'.repeat(score);
            const empty = '☆'.repeat(5 - score);
            return `<span class="filled">${filled}</span><span class="empty">${empty}</span>`;
        }

        for (const id in dataMap) {
            const el = document.getElementById(id);
            if (el) {
                // Use innerHTML if the value contains any HTML tags (e.g., <br> or <span>)
                if (typeof dataMap[id] === 'string' && (dataMap[id].includes('<br>') || dataMap[id].includes('<span'))) {
                    el.innerHTML = dataMap[id];
                } else {
                    el.textContent = dataMap[id];
                }
            }
        }



    };

    reader.readAsArrayBuffer(file);
});

function formatComparison(diffValue, unitLabel = '', precision = 1) {
    const diff = Number(diffValue);
    if (diff == null || isNaN(diff)) return '';

    if (Math.round(diff) === 0) {
    return `<span class="age-diff neutral">●&nbsp; At region avg</span>`;
}


    const absDiff = Math.abs(diff).toFixed(precision);
    const direction = diff > 0 ? 'up' : 'down';
    const arrow = diff > 0 ? '▲' : '▼';
    const label = diff > 0
        ? `${unitLabel} above region avg`
        : `${unitLabel} below region avg`;

    return `<span class="age-diff ${direction}">${arrow}&nbsp; ${absDiff} ${label}</span>`;
}

</script>
</body>
</html>